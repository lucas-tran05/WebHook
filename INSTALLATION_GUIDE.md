# H∆∞·ªõng D·∫´n C√†i ƒê·∫∑t v√† Ch·∫°y Test

## üìã Y√™u C·∫ßu H·ªá Th·ªëng

- Python 3.8 tr·ªü l√™n
- pip (Python package manager)
- Git (optional)

## üöÄ C√†i ƒê·∫∑t

### 1. Clone ho·∫∑c Download Project

```bash
# N·∫øu d√πng Git
git clone https://github.com/lucas-tran05/WebHook.git
cd WebHook

# Ho·∫∑c download ZIP v√† gi·∫£i n√©n
```

### 2. T·∫°o Virtual Environment (Khuy·∫øn ngh·ªã)

**Windows:**
```powershell
python -m venv .venv
.venv\Scripts\activate
```

**Linux/Mac:**
```bash
python3 -m venv .venv
source .venv/bin/activate
```

### 3. C√†i ƒê·∫∑t Dependencies

```bash
pip install -r requirements.txt
```

**Packages ch√≠nh:**
- FastAPI: Web framework
- Uvicorn: ASGI server
- HTTPX: HTTP client
- Pydantic: Data validation
- Rich: Terminal output formatting

## üéØ Ch·∫°y Application

### Option 1: Web Interface (Khuy·∫øn ngh·ªã)

```bash
python web_scanner.py
```

Server s·∫Ω ch·∫°y t·∫°i: **http://localhost:8080**

### Option 2: CLI Mode

```bash
python main.py --url https://webhook.site/your-unique-id
```

## üß™ Ch·∫°y Test V√≠ D·ª•

### Test 1: Schema-Based Scan v·ªõi STRIDE

T·∫°o file `test_stride_example.py`:

```python
import httpx

# ƒê·ªãnh nghƒ©a schema cho webhook
schema = [
    {"name": "event", "type": "string", "sample_value": "user.created"},
    {"name": "user_id", "type": "integer", "sample_value": "123"},
    {"name": "email", "type": "email", "sample_value": "test@example.com"}
]

# G·ª≠i request ƒë·ªÉ scan
response = httpx.post("http://localhost:8080/api/scan", json={
    "target_url": "https://webhook.site/your-unique-id",
    "shared_secret": "my_secret_key",
    "payload_schema": schema,
    "test_standards": ["STRIDE"]
}, timeout=60.0)

result = response.json()
print(f"‚úÖ ƒê√£ ch·∫°y {len(result['results'])} tests")
print(f"üìä Scan ID: {result['scan_id']}")

# In k·∫øt qu·∫£
for test in result['results'][:5]:
    print(f"\nüîç {test['name']}")
    print(f"   Status: {test['status']}")
    print(f"   Details: {test['details']}")
```

**Ch·∫°y test:**
```bash
# ƒê·∫£m b·∫£o web_scanner.py ƒëang ch·∫°y tr∆∞·ªõc
python test_stride_example.py
```

### Test 2: OWASP Top 10 v·ªõi SSRF Check

T·∫°o file `test_owasp_ssrf.py`:

```python
import httpx

schema = [
    {"name": "event", "type": "string", "sample_value": "webhook.triggered"},
    {"name": "callback_url", "type": "url", "sample_value": "https://example.com/callback"},
    {"name": "user_id", "type": "integer", "sample_value": "456"}
]

response = httpx.post("http://localhost:8080/api/scan", json={
    "target_url": "https://webhook.site/your-unique-id",
    "shared_secret": "test_secret",
    "payload_schema": schema,
    "test_standards": ["OWASP"]
}, timeout=60.0)

result = response.json()

# T√¨m SSRF tests
ssrf_tests = [t for t in result['results'] if 'SSRF' in t['name']]
print(f"üîç T√¨m th·∫•y {len(ssrf_tests)} SSRF tests")

for test in ssrf_tests:
    print(f"\n‚ö†Ô∏è  {test['name']}")
    print(f"   Status: {test['status']}")
```

**Ch·∫°y test:**
```bash
python test_owasp_ssrf.py
```

### Test 3: PCI-DSS Compliance (Cardholder Data)

T·∫°o file `test_pci_dss_example.py`:

```python
import httpx

schema = [
    {"name": "transaction_id", "type": "string", "sample_value": "txn_123456"},
    {"name": "amount", "type": "float", "sample_value": "99.99"},
    {"name": "card_token", "type": "string", "sample_value": "tok_visa_4111"}
]

response = httpx.post("http://localhost:8080/api/scan", json={
    "target_url": "https://webhook.site/your-unique-id",
    "shared_secret": "pci_test_key",
    "payload_schema": schema,
    "test_standards": ["PCI-DSS"]
}, timeout=60.0)

result = response.json()

# T√¨m CHD (Cardholder Data) tests
chd_tests = [t for t in result['results'] if 'CHD' in t['name']]
print(f"üí≥ T√¨m th·∫•y {len(chd_tests)} Cardholder Data tests")

for test in chd_tests:
    print(f"\nüîí {test['name']}")
    print(f"   Status: {test['status']}")
    if test['status'] == 'FAIL':
        print(f"   ‚ö†Ô∏è  WARNING: {test['details']}")
```

**Ch·∫°y test:**
```bash
python test_pci_dss_example.py
```

### Test 4: Full Scan (T·∫•t C·∫£ Standards)

T·∫°o file `test_full_scan.py`:

```python
import httpx
import json

schema = [
    {"name": "event", "type": "string", "sample_value": "order.created"},
    {"name": "order_id", "type": "integer", "sample_value": "789"},
    {"name": "customer_email", "type": "email", "sample_value": "customer@example.com"},
    {"name": "webhook_url", "type": "url", "sample_value": "https://example.com/notify"},
    {"name": "user_role", "type": "string", "sample_value": "customer"}
]

print("üöÄ Starting full security scan...")
print("=" * 80)

response = httpx.post("http://localhost:8080/api/scan", json={
    "target_url": "https://webhook.site/your-unique-id",
    "shared_secret": "full_scan_secret",
    "payload_schema": schema,
    "test_standards": ["STRIDE", "OWASP", "PCI-DSS"]
}, timeout=120.0)

result = response.json()

print(f"\n‚úÖ Scan Complete!")
print(f"üìä Total Tests: {len(result['results'])}")
print(f"üÜî Scan ID: {result['scan_id']}")

# Ph√¢n lo·∫°i theo standard
stride_tests = [t for t in result['results'] if 'STRIDE' in t['name']]
owasp_tests = [t for t in result['results'] if 'OWASP' in t['name']]
pci_tests = [t for t in result['results'] if 'PCI-DSS' in t['name']]

print(f"\nüìã Breakdown:")
print(f"   - STRIDE: {len(stride_tests)} tests")
print(f"   - OWASP: {len(owasp_tests)} tests")
print(f"   - PCI-DSS: {len(pci_tests)} tests")

# ƒê·∫øm PASS/FAIL
passed = len([t for t in result['results'] if t['status'] == 'PASS'])
failed = len([t for t in result['results'] if t['status'] == 'FAIL'])
warnings = len([t for t in result['results'] if t['status'] == 'WARN'])

print(f"\nüìä Results:")
print(f"   ‚úÖ PASS: {passed}")
print(f"   ‚ùå FAIL: {failed}")
print(f"   ‚ö†Ô∏è  WARN: {warnings}")

# In top 5 failed tests
if failed > 0:
    print(f"\n‚ùå Failed Tests:")
    for test in [t for t in result['results'] if t['status'] == 'FAIL'][:5]:
        print(f"   - {test['name']}")
        print(f"     Reason: {test['details']}")

# L∆∞u k·∫øt qu·∫£ ra file
with open("scan_results.json", "w") as f:
    json.dump(result, f, indent=2)
print(f"\nüíæ Results saved to: scan_results.json")
```

**Ch·∫°y test:**
```bash
python test_full_scan.py
```

### Test 5: Test V·ªõi Custom Headers

T·∫°o file `test_custom_headers.py`:

```python
import httpx

schema = [
    {"name": "event", "type": "string", "sample_value": "payment.processed"}
]

response = httpx.post("http://localhost:8080/api/scan", json={
    "target_url": "https://webhook.site/your-unique-id",
    "shared_secret": "test_secret",
    "payload_schema": schema,
    "test_standards": ["STRIDE"],
    "custom_headers": {
        "X-Api-Version": "v2",
        "X-Client-Id": "test-client-123",
        "Authorization": "Bearer test-token"
    }
}, timeout=60.0)

result = response.json()
print(f"‚úÖ Scan with custom headers: {len(result['results'])} tests")
```

**Ch·∫°y test:**
```bash
python test_custom_headers.py
```

## üåê Test Qua Web Interface

### 1. M·ªü Browser

Truy c·∫≠p: http://localhost:8080

### 2. ƒêi·ªÅn Th√¥ng Tin

**Target Webhook URL:**
```
https://webhook.site/your-unique-id
```
*L∆∞u √Ω: T·∫°o URL test t·∫°i https://webhook.site*

**Shared Secret (Optional):**
```
my_secret_key_123
```

### 3. ƒê·ªãnh Nghƒ©a Schema

Click "Add Field" v√† nh·∫≠p:

| Field Name | Type | Sample Value |
|------------|------|--------------|
| event | string | user.signup |
| user_id | integer | 12345 |
| email | email | user@example.com |
| callback_url | url | https://example.com/callback |

### 4. Ch·ªçn Security Standards

‚òëÔ∏è STRIDE  
‚òëÔ∏è OWASP  
‚òëÔ∏è PCI-DSS  

### 5. Click "Start Schema-Based Scan"

K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã real-time v·ªõi m√†u s·∫Øc:
- üü¢ **PASS**: Test th√†nh c√¥ng
- üî¥ **FAIL**: Ph√°t hi·ªán l·ªó h·ªïng
- üü° **WARN**: C·∫£nh b√°o

## üìä Hi·ªÉu K·∫øt Qu·∫£ Test

### STRIDE Tests

| Test Name | √ù Nghƒ©a | PASS = T·ªët | FAIL = L·ªó h·ªïng |
|-----------|---------|------------|----------------|
| Spoofing - Request without authentication | Ki·ªÉm tra x√°c th·ª±c | Endpoint reject request kh√¥ng c√≥ signature | Endpoint ch·∫•p nh·∫≠n request kh√¥ng x√°c th·ª±c |
| Tampering - HTTPS enforcement | Ki·ªÉm tra HTTPS | Ch·ªâ ch·∫•p nh·∫≠n HTTPS | Ch·∫•p nh·∫≠n HTTP |
| Repudiation - Logging check | Ki·ªÉm tra logging | Response c√≥ request-id header | Kh√¥ng c√≥ logging |
| InfoDisclosure - Sensitive data | Ki·ªÉm tra r√≤ r·ªâ d·ªØ li·ªáu | D·ªØ li·ªáu nh·∫°y c·∫£m b·ªã che | API key/password l·ªô ra |
| DoS - Rate limiting | Ki·ªÉm tra gi·ªõi h·∫°n request | HTTP 429 khi qu√° nhi·ªÅu request | Ch·∫•p nh·∫≠n unlimited requests |
| Privilege - SQL Injection | Ki·ªÉm tra injection | Input ƒë∆∞·ª£c sanitize | SQL injection th√†nh c√¥ng |

### OWASP Tests

| Test Name | √ù Nghƒ©a | PASS = T·ªët | FAIL = L·ªó h·ªïng |
|-----------|---------|------------|----------------|
| A01 - Cross-account access | Ki·ªÉm tra ph√¢n quy·ªÅn | Kh√¥ng th·ªÉ access d·ªØ li·ªáu user kh√°c | IDOR vulnerability |
| A03 - SQL/NoSQL Injection | Ki·ªÉm tra injection | Input ƒë∆∞·ª£c escape | Injection th√†nh c√¥ng |
| A10 - SSRF Internal IP | Ki·ªÉm tra SSRF | Ch·∫∑n localhost/10.x/192.168.x | C√≥ th·ªÉ g·ªçi internal IPs |

### PCI-DSS Tests

| Test Name | √ù Nghƒ©a | PASS = T·ªët | FAIL = L·ªó h·ªïng |
|-----------|---------|------------|----------------|
| CHD - Credit card in payload | Ki·ªÉm tra l∆∞u th·∫ª | Kh√¥ng c√≥ s·ªë th·∫ª trong logs | S·ªë th·∫ª b·ªã l∆∞u tr·ªØ |
| CHD - CVV in payload | Ki·ªÉm tra CVV | CVV kh√¥ng ƒë∆∞·ª£c store | CVV b·ªã l∆∞u (vi ph·∫°m PCI) |
| 6.5.1 - SQL Injection | Ki·ªÉm tra injection | Input ƒë∆∞·ª£c sanitize | SQL injection |

## üîß Troubleshooting

### L·ªói: ModuleNotFoundError

```bash
# C√†i ƒë·∫∑t l·∫°i dependencies
pip install -r requirements.txt
```

### L·ªói: Port 8080 ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng

**Windows:**
```powershell
# T√¨m process ƒëang d√πng port 8080
netstat -ano | findstr :8080

# Kill process (thay PID b·∫±ng s·ªë t·ª´ l·ªánh tr√™n)
taskkill /PID <PID> /F
```

**Linux/Mac:**
```bash
# T√¨m v√† kill process
lsof -ti:8080 | xargs kill -9
```

### L·ªói: Connection timeout

- Ki·ªÉm tra internet connection
- TƒÉng timeout trong code:
```python
response = httpx.post(..., timeout=120.0)  # 120 seconds
```

### L·ªói: 422 Unprocessable Entity

- Ki·ªÉm tra request body c√≥ ƒë√∫ng format kh√¥ng
- Field `target_url` l√† required (kh√¥ng ph·∫£i `url`)
- Field `payload_schema` ph·∫£i l√† array of objects

## üìö API Documentation

Khi server ch·∫°y, truy c·∫≠p: http://localhost:8080/docs

Interactive API documentation v·ªõi Swagger UI:
- Test API tr·ª±c ti·∫øp t·ª´ browser
- Xem request/response schema
- Download OpenAPI spec

## üéì Examples Repository

T·∫•t c·∫£ c√°c test examples tr√™n c√≥ th·ªÉ download t·∫°i:
https://github.com/lucas-tran05/WebHook/tree/main/examples

## üí° Tips

1. **D√πng webhook.site ƒë·ªÉ test:**
   - T·∫°o unique URL t·∫°i https://webhook.site
   - Xem real-time requests ƒë∆∞·ª£c g·ª≠i
   - Kh√¥ng c·∫ßn setup backend th·∫≠t

2. **Test t·ª´ng standard ri√™ng tr∆∞·ªõc:**
   - Start v·ªõi `["STRIDE"]` ƒë·ªÉ hi·ªÉu flow
   - Sau ƒë√≥ test `["OWASP"]` v√† `["PCI-DSS"]`
   - Cu·ªëi c√πng test all 3 c√πng l√∫c

3. **Save k·∫øt qu·∫£:**
   ```python
   with open("results.json", "w") as f:
       json.dump(result, f, indent=2)
   ```

4. **Check logs:**
   - Server logs hi·ªÉn th·ªã chi ti·∫øt m·ªói request
   - D√πng ƒë·ªÉ debug khi test fail

## üÜò Support

Issues: https://github.com/lucas-tran05/WebHook/issues  
Email: lucas.tran05@example.com

## üìù License

MIT License - Free to use and modify
